# This goes into /etc/asound.conf
# --- PART 1: INPUT (PS3 Eye on Card 0) ---
pcm.ps3eye_snoop {
    type dsnoop
    ipc_key 2222
    ipc_key_add_uid false
    slave {
        pcm "hw:0,0"      # PS3 Eye is Card 0
        channels 4
        rate 16000
        period_size 1024
        buffer_size 4096
    }
}

pcm.ps3eye_mono {
    type route
    slave.pcm "ps3eye_snoop"
    slave.channels 4
    ttable.0.0 0.25
    ttable.1.0 0.25
    ttable.2.0 0.25
    ttable.3.0 0.25
}

pcm.jarvis_mic {
    type plug
    slave.pcm "ps3eye_mono"
}

# --- PART 2: OUTPUT (Voice Bonnet on Card 1) ---
pcm.bonnet_dmix {
    type dmix
    ipc_key 1024
    ipc_key_add_uid false
    slave {
        pcm "hw:1,0"      # AIY Bonnet is Card 1
        period_size 1024
        buffer_size 8192
        rate 48000
    }
}

pcm.bonnet_stereo {
    type plug
    slave {
        pcm "bonnet_dmix"
        channels 2
    }
}

# --- PART 3: DEFAULT ROUTING ---
pcm.!default {
    type asym
    playback.pcm "bonnet_stereo"
    capture.pcm "jarvis_mic"
}

ctl.!default {
    type hw
    card 1                # Use Card 1 (Bonnet) for amixer controls
}